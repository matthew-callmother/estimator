{
  "meta": {
    "version": "v2",
    "lock_hours": 72,
    "currency": "USD"
  },
  "pricing": {
    "drivers": {
      "type": "type",
      "fuel": "fuel",
      "location": "location",
      "access": "access",
      "urgency": "urgency",
      "venting": "venting"
    },
    "exact_requires": ["addr_street", "addr_city", "addr_state", "addr_zip"],
    "base_price": {
      "tank_gas": 4200,
      "tank_electric": 3400,
      "tankless_gas": 7900,
      "tankless_electric": 6400
    },
    "modifiers": {
      "location": {
        "garage": 0,
        "attic": 650,
        "closet": 450,
        "other": 550
      },
      "venting": {
        "standard": 0,
        "power_vent": 950,
        "not_sure": 450,
        "na": 0
      },
      "access": {
        "easy": 0,
        "tight": 550,
        "not_sure": 300
      },
      "urgency": {
        "asap": 250,
        "week": 0,
        "month": 0
      },
      "fuel_not_sure_penalty": 350
    },
    "safety": {
      "round_to": 25,
      "max_reasonable_price": 20000,
      "min_reasonable_price": 500
    }
  },
  "questions": [
    {
      "id": "type",
      "type": "single_select",
      "title": "What kind of water heater do you have?",
      "subtitle": "This sets the equipment + labor baseline.",
      "tooltip": "Tankless installs usually require more labor and venting considerations.",
      "image_url": "",
      "affects_pricing": true,
      "options": [
        { "value": "tank", "label": "Tank", "image_url": "https://cdn.prod.website-files.com/678144dfb4c536263e714199/6959542f801a71c999749c88_conventional.png" },
        { "value": "tankless", "label": "Tankless", "image_url": "https://cdn.prod.website-files.com/678144dfb4c536263e714199/695954b2a011b846bd420fac_tankless-wireframe.png" }
      ]
    },
    {
      "id": "fuel",
      "type": "single_select",
      "title": "What fuel does it use?",
      "subtitle": "Fuel affects venting, hookups, and code requirements.",
      "tooltip": "If you’re not sure, we add padding to avoid false precision.",
      "affects_pricing": true,
      "options": [
        { "value": "gas", "label": "Gas", "image_url": "" },
        { "value": "electric", "label": "Electric", "image_url": "" },
        { "value": "not_sure", "label": "Not sure", "image_url": "" }
      ]
    },
    {
      "id": "location",
      "type": "single_select",
      "title": "Where is the water heater installed?",
      "subtitle": "Access and safety requirements can change install time.",
      "tooltip": "Attic installs often require more time and safety setup.",
      "affects_pricing": true,
      "options": [
        { "value": "garage", "label": "Garage", "image_url": "" },
        { "value": "attic", "label": "Attic", "image_url": "" },
        { "value": "closet", "label": "Closet", "image_url": "" },
        { "value": "other", "label": "Other", "image_url": "" }
      ]
    },
    {
      "id": "venting",
      "type": "single_select",
      "title": "What type of venting does it have?",
      "subtitle": "Gas venting can materially change parts + labor.",
      "tooltip": "If you pick “Not sure,” we include a safety buffer.",
      "depends_on": { "question_id": "fuel", "equals": "gas" },
      "affects_pricing": true,
      "options": [
        { "value": "standard", "label": "Standard vent", "image_url": "" },
        { "value": "power_vent", "label": "Power vent", "image_url": "" },
        { "value": "not_sure", "label": "Not sure", "image_url": "" }
      ]
    },
    {
      "id": "access",
      "type": "single_select",
      "title": "How easy is the access to the heater?",
      "subtitle": "Tight spaces take longer and need more care.",
      "tooltip": "‘Tight’ means limited clearance to work safely around the unit.",
      "affects_pricing": true,
      "options": [
        { "value": "easy", "label": "Easy", "image_url": "" },
        { "value": "tight", "label": "Tight", "image_url": "" },
        { "value": "not_sure", "label": "Not sure", "image_url": "" }
      ]
    },
    {
      "id": "urgency",
      "type": "single_select",
      "title": "How soon do you need hot water back?",
      "subtitle": "Timing helps us set expectations and prioritize.",
      "tooltip": "ASAP may require schedule shuffling, which can affect cost slightly.",
      "affects_pricing": true,
      "options": [
        { "value": "asap", "label": "ASAP (no hot water)", "image_url": "" },
        { "value": "week", "label": "This week", "image_url": "" },
        { "value": "month", "label": "1–4 weeks", "image_url": "" }
      ]
    },

    {
      "id": "address_gate",
      "type": "form",
      "title": "Want an even more precise estimate?",
      "subtitle": "Enter your address so we can look at permitting requirements.",
      "affects_pricing": false,
      "fields": [
        {
          "id": "addr_street",
          "label": "Street",
          "input_type": "text",
          "required": true,
          "placeholder": "123 Main St",
          "autocomplete": "street-address",
          "help": "We use this to validate city permitting requirements."
        },
        {
          "id": "addr_city",
          "label": "City",
          "input_type": "text",
          "required": true,
          "placeholder": "Frisco",
          "autocomplete": "address-level2"
        },
        {
          "id": "addr_state",
          "label": "State",
          "input_type": "text",
          "required": true,
          "placeholder": "TX",
          "autocomplete": "address-level1",
          "pattern": "^[A-Za-z]{2}$",
          "pattern_msg": "Use a 2-letter state code (e.g., TX)"
        },
        {
          "id": "addr_zip",
          "label": "Zip",
          "input_type": "text",
          "required": true,
          "placeholder": "75034",
          "autocomplete": "postal-code",
          "pattern": "^\\d{5}(-\\d{4})?$",
          "pattern_msg": "Use a 5-digit ZIP"
        }
      ],
      "next_label": "Continue"
    },

    {
      "id": "permit_check",
      "type": "loading_lookup",
      "transient": true,
      "title": "Checking permit + code requirements…",
      "subtitle": "Verifying municipality permit fees and requirements for your address.",
      "duration_ms": 2800,
      "lookup": {
        "source": "municipalities",
        "match_on": "addr_city",
        "write_to": {
          "permit_fee_usd": "permit_fee_usd",
          "expansion_tank_required": "expansion_tank_required"
        }
      },
      "writes": ["permit_fee_usd", "expansion_tank_required", "municipality_city", "municipality_found"],
      "auto_advance": true,
      "affects_pricing": false
    },


    {
      "id": "contact_gate",
      "type": "form",
      "title": "Lock in this estimate for 72 hours",
      "subtitle": "Submit your contact info to lock in this estimate for 72 hours.",
      "affects_pricing": false,
      "fields": [
        {
          "id": "contact_name",
          "label": "Name",
          "input_type": "text",
          "required": true,
          "placeholder": "Full name",
          "autocomplete": "name"
        },
        {
          "id": "contact_phone",
          "label": "Phone",
          "input_type": "tel",
          "required": true,
          "type": "phone",
          "min_digits": 10,
          "placeholder": "(555) 555-5555",
          "autocomplete": "tel"
        },
        {
          "id": "contact_email",
          "label": "Email",
          "input_type": "email",
          "required": true,
          "type": "email",
          "placeholder": "you@email.com",
          "autocomplete": "email"
        }
      ],
      "next_label": "Review"
    },

    {
      "id": "results_preview",
      "type": "summary",
      "title": "Your estimate",
      "subtitle": "Review your estimate before submitting.",
      "affects_pricing": false,
      "next_label": "Get My Estimate"
    },

    {
      "id": "submit",
      "type": "submit",
      "title": "Submit",
      "subtitle": "We’ll hold this estimate for 72 hours.",
      "affects_pricing": false,
      "submit_label": "Submit"
    }
  ],
  "result_copy": {
    "includes": [
      "Removal + haul-away",
      "Standard installation materials",
      "Code-required basics (as applicable)"
    ],
    "could_change": [
      "Venting or access differs from selections",
      "Hidden damage or unexpected platform work",
      "Non-standard gas/electrical changes beyond a typical swap"
    ],
    "disclaimer": "This is an estimate based on your selections. Final price can change if conditions differ on-site."
  }
}
